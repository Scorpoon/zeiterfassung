<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" lang="de">
  <head>
    <title>Zeiterfassung - Personen</title>
  </head>
  <body>
    <th:block th:fragment="section(user, workingTimes)">
      <div>
        <a
          href="#"
          th:href="@{/users/{id}/working-time/new (id=${user.id}, query=${query})}"
          class="flex items-center gap-1"
          data-turbo-action="advance"
        >
          <svg th:replace="~{icons/plus::svg(className='w-5 h-5')}"></svg>
          <span
            class="underline"
            th:text="#{usermanagement.working-time.add-new-working-time-entry}"
          >
            neue Arbeitszeit hinzufügen
          </span>
        </a>
      </div>
      <th:block th:if="${#lists.size(workingTimes) > 1}">
        <ul class="mt-8">
          <li th:each="workingTime : ${workingTimes}">
            <details
              th:fragment="working-time-block(opened)"
              th:attrappend="open=${opened ? 'true' : null}"
            >
              <summary class="cursor-pointer font-bold">
                <th:block
                  th:if="${workingTime.validFrom == null}"
                  th:text="#{usermanagement.working-time.single-working-time-summary}"
                >
                  gültige Arbeitszeit
                </th:block>
                <th:block
                  th:if="${workingTime.validFrom != null}"
                  th:text="#{usermanagement.working-time.multiple-working-time-summary(${workingTime.validFrom})}"
                >
                  gültig von XX.XX.XXXX bis endlos
                </th:block>
              </summary>
              <div class="mt-4 flex flex-col gap-8">
                <div
                  class="flex items-center gap-2"
                  th:with="index=${workingTimeStat == null ? 0 : workingTimeStat.index}"
                >
                  <a
                    href="#"
                    th:href="@{/users/{id}/working-time/{workingTimeId} (id=${user.id},workingTimeId=${workingTime.id})}"
                    class="flex items-center gap-2 py-1 pl-3 pr-4 text-gray-400 border border-gray-300 bg-white rounded-lg transition-colors hover:text-gray-500 hover:border-gray-500 focus:text-gray-500 focus:border-gray-500"
                    data-turbo-action="advance"
                  >
                    <svg
                      th:replace="~{icons/edit::svg(className='w-4 h-4')}"
                    ></svg>
                    <th:block>Bearbeiten</th:block>
                  </a>
                  <form
                    action="#"
                    th:action="@{/users/{id}/working-time/{workingTimeId}/delete (id=${user.id},workingTimeId=${workingTime.id})}"
                    th:if="${#lists.size(workingTimes) > 1}"
                  >
                    <button
                      type="submit"
                      class="flex items-center gap-2 py-1 pl-3 pr-4 text-gray-400 border border-gray-300 bg-white rounded-lg transition-colors hover:text-gray-500 hover:border-gray-500 focus:text-gray-500 focus:border-gray-500"
                    >
                      <svg
                        th:replace="~{icons/trash::svg(className='w-4 h-4')}"
                      ></svg>
                      <th:block>Löschen</th:block>
                    </button>
                  </form>
                </div>
                <fieldset class="border-t border-gray-100">
                  <legend
                    class="text-sm font-medium text-gray-400"
                    th:text="#{usermanagement.working-time.workdays.title}"
                  >
                    Arbeitstage
                  </legend>
                  <div class="mt-2 sm:mt-4">
                    <ul class="flex flex-wrap gap-4">
                      <li
                        class="flex items-center gap-1"
                        th:fragment="workday(dayOfWeek)"
                        th:with="dayOfWeek=${dayOfWeek ?: 'monday'}"
                      >
                        <input
                          type="checkbox"
                          name="workday"
                          value="monday"
                          th:value="${dayOfWeek}"
                          id="workday-monday"
                          th:id="${'workday-' + dayOfWeek}"
                          th:checked="${#lists.contains(workingTime.workday, dayOfWeek)}"
                          disabled
                        />
                        <label
                          for="workday-monday"
                          th:for="${'workday-' + dayOfWeek}"
                          th:text="${#messages.msg(dayOfWeek.toUpperCase())}"
                        >
                          Montag
                        </label>
                      </li>
                      <li th:replace="~{::workday('tuesday')}"></li>
                      <li th:replace="~{::workday('wednesday')}"></li>
                      <li th:replace="~{::workday('thursday')}"></li>
                      <li th:replace="~{::workday('friday')}"></li>
                      <li th:replace="~{::workday('saturday')}"></li>
                      <li th:replace="~{::workday('sunday')}"></li>
                    </ul>
                  </div>
                </fieldset>
                <fieldset class="border-t border-gray-100">
                  <legend
                    class="text-sm font-medium text-gray-400"
                    th:text="#{usermanagement.working-time.hours.common.title}"
                  >
                    Arbeitszeit
                  </legend>
                  <div class="mt-2 sm:mt-4">
                    <div
                      class="flex items-center gap-2 sm:grid sm:grid-cols-7 sm:gap-4"
                    >
                      <input
                        type="text"
                        inputmode="numeric"
                        name="workingTime"
                        id="input-workingtime"
                        class="border border-gray-300 px-2 py-1 w-14 sm:w-full"
                        th:value="${workingTime.workingTime}"
                        disabled
                      />
                      <label
                        for="input-workingtime"
                        class="col-span-6"
                        th:text="#{usermanagement.working-time.hours.common.input.label}"
                      >
                        Stunden am Tag
                      </label>
                    </div>
                  </div>
                </fieldset>
                <fieldset class="border-t border-gray-100">
                  <legend
                    class="text-sm font-medium text-gray-400"
                    th:text="#{usermanagement.working-time.hours.individual.title}"
                  >
                    Individuelle Arbeitszeit
                  </legend>
                  <div
                    class="mt-2 flex flex-col gap-2 sm:mt-4 sm:grid sm:grid-cols-7 sm:gap-4"
                  >
                    <div
                      th:replace="~{usermanagement/user/working-time-settings_working-time-weekday::box('monday', ${workingTime.workingTimeMonday})}"
                    ></div>
                    <div
                      th:replace="~{usermanagement/user/working-time-settings_working-time-weekday::box('tuesday', ${workingTime.workingTimeTuesday})}"
                    ></div>
                    <div
                      th:replace="~{usermanagement/user/working-time-settings_working-time-weekday::box('wednesday', ${workingTime.workingTimeWednesday})}"
                    ></div>
                    <div
                      th:replace="~{usermanagement/user/working-time-settings_working-time-weekday::box('thursday', ${workingTime.workingTimeThursday})}"
                    ></div>
                    <div
                      th:replace="~{usermanagement/user/working-time-settings_working-time-weekday::box('friday', ${workingTime.workingTimeFriday})}"
                    ></div>
                    <div
                      th:replace="~{usermanagement/user/working-time-settings_working-time-weekday::box('saturday', ${workingTime.workingTimeSaturday})}"
                    ></div>
                    <div
                      th:replace="~{usermanagement/user/working-time-settings_working-time-weekday::box('sunday', ${workingTime.workingTimeSunday})}"
                    ></div>
                  </div>
                </fieldset>
              </div>
            </details>
          </li>
        </ul>
      </th:block>
      <th:block
        th:if="${#lists.size(workingTimes) eq 1}"
        th:with="workingTime=${workingTimes[0]}"
      >
        <div class="mt-8">
          <details th:replace="~{::working-time-block(opened=true)}"></details>
        </div>
      </th:block>
    </th:block>
  </body>
</html>
